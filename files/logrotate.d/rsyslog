################################################################################
#                                                                              #
#                    SYSTEM LOG FILE ROTATION CONFIGURATION                    #
#                                                                              #
#                   ROTADO DE FICHEROS DE LOGS DEL SISTEMA                     #
#                                                                              #
################################################################################

# /var/log/boot.log contains system boot messages generated by
# systemd or the init system
# ---
# /var/log/boot.log contiene los mensajes de inicio de sistema generados por
# systemd o el sistema de arranque (init)

/var/log/boot.log {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log weekly
	# ---
	# Rotar el log semanalmente
	weekly

	# Keep 5 rotated log files
	# ---
	# Conservar 5 archivos rotados
	rotate 5

	# Do not keep logs older than 60 days,
	# even if the 5 rotations have not been used
	# ---
	# No mantener logs de más de 60 días,
	# incluso si no se alcanzan las 5 rotaciones
	maxage 60

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Create a new log file after rotation with 0664 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0664,
	# propietario root y grupo root
	create 0664 root root

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

}

# /var/log/cron is used for scheduled tasks and their outputs
# ---
# /var/log/cron es usado por tareas programadas y sus salidas

/var/log/cron {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log weekly
	# ---
	# Rotar el log semanalmente
	weekly

	# Keep 14 rotated log files
	# ---
	# Conservar 14 archivos rotados
	rotate 14

	# Do not keep logs older than 180 days,
	# even if the 14 rotations have not been used
	# ---
	# No mantener logs de más de 180 días,
	# incluso si no se alcanzan las 14 rotaciones
	maxage 180

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Create a new log file after rotation with 0664 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0664,
	# propietario root y grupo root
	create 0664 root root

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

	# Compress starting from the second rotated file (the most recent one
	# is not compressed until the next rotation)
	# ---
	# Comprimir a partir del segundo archivo rotado (el más reciente no se
	# comprime hasta la siguiente rotación)
	delaycompress

	# Block of commands to run after rotation
	# ---
	# El bloque de comando que se ejecuta tras rotar
	postrotate
		# Send a HUP signal to rsyslog to reopen its log files
		# after rotation (essential to avoid losing logs)
		# ---
		# Envía una señal HUP al servicio rsyslog para que vuelva a abrir sus
		# archivos de log tras la rotación (imprescindible para no perder logs)
		/usr/bin/systemctl kill -s HUP rsyslog.service >/dev/null 2>&1 || true
	endscript

}

# /var/log/maillog is used by mail services
# ---
# /var/log/maillog es usado por servicios de correo

/var/log/maillog {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log weekly
	# ---
	# Rotar el log semanalmente
	weekly

	# Keep 14 rotated log files
	# ---
	# Conservar 14 archivos rotados
	rotate 14

	# Do not keep logs older than 180 days,
	# even if the 14 rotations have not been used
	# ---
	# No mantener logs de más de 180 días,
	# incluso si no se alcanzan las 14 rotaciones
	maxage 180

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Create a new log file after rotation with 0600 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0600,
	# propietario root y grupo root
	create 0600 root root

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

	# Compress starting from the second rotated file (the most recent one
	# is not compressed until the next rotation)
	# ---
	# Comprimir a partir del segundo archivo rotado (el más reciente no se
	# comprime hasta la siguiente rotación)
	delaycompress

	# Block of commands to run after rotation
	# ---
	# El bloque de comando que se ejecuta tras rotar
	postrotate
		# Send a HUP signal to rsyslog to reopen its log files
		# after rotation (essential to avoid losing logs)
		# ---
		# Envía una señal HUP al servicio rsyslog para que vuelva a abrir sus
		# archivos de log tras la rotación (imprescindible para no perder logs)
		/usr/bin/systemctl kill -s HUP rsyslog.service >/dev/null 2>&1 || true
	endscript

}

# /var/log/messages contains general system messages
# ---
# /var/log/messages contiene mensajes generales del sistema

/var/log/messages {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log weekly
	# ---
	# Rotar el log semanalmente
	weekly

	# Keep 14 rotated log files
	# ---
	# Conservar 14 archivos rotados
	rotate 14

	# Do not keep logs older than 180 days,
	# even if the 14 rotations have not been used
	# ---
	# No mantener logs de más de 180 días,
	# incluso si no se alcanzan las 14 rotaciones
	maxage 180

	# Create a new log file after rotation with 0660 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0600,
	# propietario root y grupo root
	create 0600 root root

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

	# Compress starting from the second rotated file (the most recent one
	# is not compressed until the next rotation)
	# ---
	# Comprimir a partir del segundo archivo rotado (el más reciente no se
	# comprime hasta la siguiente rotación)
	delaycompress

	# Block of commands to run after rotation
	# ---
	# El bloque de comando que se ejecuta tras rotar
	postrotate
		# Send a HUP signal to rsyslog to reopen its log files
		# after rotation (essential to avoid losing logs)
		# ---
		# Envía una señal HUP al servicio rsyslog para que vuelva a abrir sus
		# archivos de log tras la rotación (imprescindible para no perder logs)
		/usr/bin/systemctl kill -s HUP rsyslog.service >/dev/null 2>&1 || true
	endscript

}

# /var/log/secure logs access attempts, authentication, sudo, etc.
# ---
# /var/log/secure registra intentos de acceso, autenticación, sudo, etcétera

/var/log/secure {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log monthly
	# ---
	# Rotar el log mensualmente
	monthly

	# Keep 12 rotated log files
	# ---
	# Conservar 12 archivos rotados
	rotate 12

	# Do not keep logs older than 366 days,
	# even if the 12 rotations have not been used
	# ---
	# No mantener logs de más de 366 días,
	# incluso si no se alcanzan las 12 rotaciones
	maxage 366

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Create a new log file after rotation with 0600 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0600,
	# propietario root y grupo root
	create 0600 root root

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

	# Compress starting from the second rotated file (the most recent one
	# is not compressed until the next rotation)
	# ---
	# Comprimir a partir del segundo archivo rotado (el más reciente no se
	# comprime hasta la siguiente rotación)
	delaycompress

	# Block of commands to run after rotation
	# ---
	# El bloque de comando que se ejecuta tras rotar
	postrotate
		# Send a HUP signal to rsyslog to reopen its log files
		# after rotation (essential to avoid losing logs)
		# ---
		# Envía una señal HUP al servicio rsyslog para que vuelva a abrir sus
		# archivos de log tras la rotación (imprescindible para no perder logs)
		/usr/bin/systemctl kill -s HUP rsyslog.service >/dev/null 2>&1 || true
	endscript

}

# /var/log/spooler is used by printing systems
# ---
# /var/log/spooler es usado por sistemas de impresión

/var/log/spooler {

	# Do not show an error if the file does not exist
	# ---
	# No mostrar error si el archivo no existe
	missingok

	# Do not rotate if the file is empty
	# ---
	# No rotar si el archivo está vacío
	notifempty

	# Rotate the log weekly
	# ---
	# Rotar el log semanalmente
	weekly

	# Keep 5 rotated log files
	# ---
	# Conservar 5 archivos rotados
	rotate 5

	# Do not keep logs older than 60 days,
	# even if the 5 rotations have not been used
	# ---
	# No mantener logs de más de 60 días,
	# incluso si no se alcanzan las 5 rotaciones
	maxage 60

	# Only rotate if the file exceeds 1MB
	# ---
	# Solo rotar si el archivo supera 1MB
	minsize 1M

	# Create a new log file after rotation with 0600 permissions,
	# owned by root and group root
	# ---
	# Crear el nuevo archivo de log tras la rotación, con permisos 0600,
	# propietario root y grupo root
	create 0600 root root

	# Add the date as a suffix in the rotated file name
	# ---
	# Añadir la fecha como sufijo en el nombre del archivo rotado
	dateext

	# Compress rotated logs to save space
	# ---
	# Comprimir los archivos rotados para ahorrar espacio
	compress

	# Compress starting from the second rotated file (the most recent one
	# is not compressed until the next rotation)
	# ---
	# Comprimir a partir del segundo archivo rotado (el más reciente no se
	# comprime hasta la siguiente rotación)
	delaycompress

	# Block of commands to run after rotation
	# ---
	# El bloque de comando que se ejecuta tras rotar
	postrotate
		# Send a HUP signal to rsyslog to reopen its log files
		# after rotation (essential to avoid losing logs)
		# ---
		# Envía una señal HUP al servicio rsyslog para que vuelva a abrir sus
		# archivos de log tras la rotación (imprescindible para no perder logs)
		/usr/bin/systemctl kill -s HUP rsyslog.service >/dev/null 2>&1 || true
	endscript

}
